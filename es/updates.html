<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actualizaciones y Registro de Cambios - Tap & Build: Idle Factory Tycoon</title>
    <meta name="description" content="√öltimas actualizaciones, notas de parche y registro de cambios para Tap & Build. ¬°Mira las novedades de cada versi√≥n!">
    <meta name="robots" content="index, follow">
    
    <link rel="canonical" href="https://tapandbuild.com/es/updates.html">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tapandbuild.com/es/updates.html">
    <meta property="og:title" content="üìã Actualizaciones y Cambios - Tap & Build">
    <meta property="og:description" content="√öltimas actualizaciones, notas de parche y registro de cambios para Tap & Build. ¬°Mira las novedades de cada versi√≥n!">
    <meta property="og:image" content="https://tapandbuild.com/og-facebook.jpg">
    <meta property="og:site_name" content="Tap & Build">
    
    <meta name="theme-color" content="#FF9F1C">
    
    <link rel="icon" href="../favicon.ico" sizes="48x48">
    <link rel="icon" href="../favicon-96.png" type="image/png" sizes="96x96">
    <link rel="icon" href="../favicon-192.png" type="image/png" sizes="192x192">
    <link rel="apple-touch-icon" href="../apple-touch-icon.png" sizes="180x180">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Blog",
        "name": "Tap & Build Updates",
        "description": "√öltimas actualizaciones, notas de parche y registro de cambios para Tap & Build. ¬°Mira las novedades de cada versi√≥n!",
        "url": "https://tapandbuild.com/es/updates.html",
        "publisher": {
            "@type": "Organization",
            "name": "Habbi Games",
            "logo": "https://tapandbuild.com/favicon-512.png"
        }
    }
    </script>
    
    <link rel="stylesheet" href="../updates-styles.css">
</head>
<body>
    <header>
        <a href="index.html" class="logo-link">
            <div class="logo-icon">üè≠</div>
            <span class="logo-text">TAP & BUILD</span>
        </a>
        <h1>üìã Actualizaciones y Cambios</h1>
        <p class="subtitle">Mantente al d√≠a con las √∫ltimas funciones, mejoras y correcciones</p>
    </header>

    <div class="container">
        <a href="index.html" class="back-link">‚Üê Volver al Inicio</a>

        <div id="releases-container">
            <div class="loading">
                <div class="loading-spinner"></div>
                <p>Cargando versiones...</p>
            </div>
        </div>

        <div class="cta-section">
            <h2>¬øListo para Construir tu Imperio?</h2>
            <p>¬°Descarga Tap & Build gratis y comienza tu aventura de magnate industrial!</p>
            <a href="https://play.google.com/store/apps/details?id=com.tapandbuild.game" class="cta-button" target="_blank" rel="noopener">
                <span>‚ñ∂</span> Descargar en Google Play
            </a>
        </div>

        <footer>
            <p>¬© 2026 Tap & Build por Habbi Games</p>
            <p style="margin-top: 10px;">
                <a href="privacy.html">Pol√≠tica de Privacidad</a> ¬∑ 
                <a href="terms.html">T√©rminos de Servicio</a> ¬∑ 
                <a href="press.html">Kit de Prensa</a>
            </p>
        </footer>
    </div>

    <script>
        // Translations object for JavaScript
        const T = {
            latestUpdates: "√öltimas Actualizaciones",
            buildHistory: "Historial de Versiones",
            earlierBuilds: "versiones anteriores",
            totalBuilds: "Total de Versiones",
            latestBuild: "√öltima Versi√≥n",
            currentVersion: "Versi√≥n Actual",
            latest: "Nuevo",
            release: "Lanzamiento",
            build: "Build",
            changes: "cambios",
            noChanges: "Sin cambios documentados.",
            noBuilds: "No se encontraron versiones.",
            loadError: "Error al cargar el historial de versiones"
        };

        const BUILDS_URL = '../builds.json';
        const DATE_LOCALE = 'es-ES';

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString(DATE_LOCALE, {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function formatShortDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString(DATE_LOCALE, {
                month: 'short',
                day: 'numeric'
            });
        }

        function renderChanges(changes) {
            if (!changes) return '<p>' + T.noChanges + '</p>';
            const changesList = Array.isArray(changes) ? changes : [changes];
            if (changesList.length === 0) return '<p>' + T.noChanges + '</p>';
            return '<ul>' + changesList.map(change => '<li>' + change + '</li>').join('') + '</ul>';
        }

        // Derive major versions from builds data (versions that change, not just build numbers)
        let majorVersions = new Set();
        function isMajorVersion(version, builds) {
            // A version is "major" if it's a new version number (not just a build bump)
            // We'll mark the first occurrence of each version as major
            if (!majorVersions.size && builds) {
                const seen = new Set();
                builds.forEach(b => {
                    if (!seen.has(b.version)) {
                        majorVersions.add(b.version);
                        seen.add(b.version);
                    }
                });
            }
            return majorVersions.has(version);
        }

        // Title now comes from builds.json data

        function renderBuild(build, isLatest = false, isExpanded = false) {
            const date = formatDate(build.date);
            const changes = renderChanges(build.changes);
            const title = build.title || (T.build + ' ' + build.build + ' Update');
            const isMajor = isMajorVersion(build.version);
            
            return `
                <article class="update-card ${isLatest ? 'latest' : ''} ${isMajor ? 'major-release' : 'minor-build'}" data-build="${build.build}">
                    <div class="update-header">
                        <div class="version-info">
                            <span class="version">v${build.version}</span>
                            <span class="build-code">${T.build} ${build.build}</span>
                            ${isLatest ? '<span class="version-badge">' + T.latest + '</span>' : ''}
                            ${isMajor ? '<span class="version-badge major">' + T.release + '</span>' : ''}
                        </div>
                        <span class="date">${date}</span>
                    </div>
                    <h2 class="update-title">${title}</h2>
                    <div class="update-body">
                        ${changes}
                    </div>
                </article>
            `;
        }

        function renderCompactBuild(build) {
            const shortDate = formatShortDate(build.date);
            const changes = Array.isArray(build.changes) ? build.changes : [build.changes];
            const mainChange = changes[0] || 'Update';
            const changeCount = changes.length;
            const allChangesHtml = changes.map(c => '<li>' + c + '</li>').join('');
            
            return `
                <div class="timeline-item" data-build="${build.build}" onclick="this.classList.toggle('expanded')">
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <div class="timeline-header">
                            <span class="timeline-build">${T.build} ${build.build}</span>
                            <span class="timeline-version">v${build.version}</span>
                            ${changeCount > 1 ? '<span class="change-count">' + changeCount + ' ' + T.changes + '</span>' : ''}
                            <span class="timeline-date">${shortDate}</span>
                        </div>
                        <div class="timeline-preview">
                            <span class="expand-icon">‚ñ∂</span>
                            <span>${mainChange}</span>
                        </div>
                        <div class="timeline-changes">
                            <ul>${allChangesHtml}</ul>
                        </div>
                    </div>
                </div>
            `;
        }

        async function loadBuilds() {
            const container = document.getElementById('releases-container');
            
            try {
                const response = await fetch(BUILDS_URL);
                
                if (!response.ok) {
                    throw new Error(T.loadError + ': ' + response.status);
                }
                
                const data = await response.json();
                const builds = data.builds || [];
                
                if (builds.length === 0) {
                    container.innerHTML = '<p class="error-message">' + T.noBuilds + '</p>';
                    return;
                }
                
                builds.sort((a, b) => b.build - a.build);
                
                // Initialize major versions from the builds data
                isMajorVersion(null, builds);
                
                const latestBuilds = builds.slice(0, 5);
                const olderBuilds = builds.slice(5);
                
                let html = '<div class="section-title">' + T.latestUpdates + '</div>';
                html += latestBuilds.map((build, index) => renderBuild(build, index === 0)).join('');
                
                if (olderBuilds.length > 0) {
                    html += `
                        <div class="section-title timeline-title">
                            ${T.buildHistory} 
                            <span class="build-count">${olderBuilds.length} ${T.earlierBuilds}</span>
                        </div>
                        <div class="timeline">
                            ${olderBuilds.map(build => renderCompactBuild(build)).join('')}
                        </div>
                    `;
                }
                
                html += `
                    <div class="build-stats">
                        <div class="stat">
                            <span class="stat-value">${builds.length}</span>
                            <span class="stat-label">${T.totalBuilds}</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">${builds[0].build}</span>
                            <span class="stat-label">${T.latestBuild}</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">v${builds[0].version}</span>
                            <span class="stat-label">${T.currentVersion}</span>
                        </div>
                    </div>
                `;
                
                container.innerHTML = html;
                
            } catch (error) {
                console.error('Error fetching builds:', error);
                container.innerHTML = `
                    <div class="error-message">
                        <p>‚ö†Ô∏è ${T.loadError}</p>
                        <p style="margin-top: 10px; font-size: 0.9rem;">${error.message}</p>
                    </div>
                `;
            }
        }

        document.addEventListener('DOMContentLoaded', loadBuilds);
    </script>
</body>
</html>